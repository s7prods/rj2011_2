<header v-deep class="headerbar_container">
    <a class="favicon" href="http://xxzrjzx.com/" target="_blank"><img src="public/favicon.png" alt="RJ2011 Icon"></a>

    <Component ref="menu" :is="popupMenuIsOpen ? 'menu-modal-dialog' : 'div'" class="el-menu-container" :data-is-popup="popupMenuIsOpen" @click.self="closePopupMenu">
        <ElMenu :default-active="activeIndex" :mode="popupMenuIsOpen ? 'vertical' : 'horizontal'" @select="handleSelect">
            <ElMenuItem index="/">首页</ElMenuItem>
            <ElSubMenu index="study">
                <template #title>学习</template>
                <ElMenuItem index="/circle/">内卷</ElMenuItem>
                <ElMenuItem index="/homework/">作业</ElMenuItem>
                <ElMenuItem index="/ranks/">排行榜</ElMenuItem>
            </ElSubMenu>
            <ElSubMenu index="lao">
                <template #title>劳</template>
                <ElMenuItem index="/lao/#lao-1">劳</ElMenuItem>
                <ElMenuItem index="/lao/#lao-2">攒劲劳</ElMenuItem>
                <ElMenuItem index="/tasks/">任务</ElMenuItem>
                <ElSubMenu index="discussion">
                    <template #title>讨论</template>
                    <ElMenuItem index="/#/discussions/">讨论</ElMenuItem>
                    <ElMenuItem index="/#/feedback/">反馈</ElMenuItem>
                </ElSubMenu>
            </ElSubMenu>
            <ElMenuItem index="/search/">搜索</ElMenuItem>
            <ElMenuItem index="/settings/">设置</ElMenuItem>
            <ElMenuItem index="/about/">关于</ElMenuItem>
        </ElMenu>
    </Component>

    <div class="m-menu"><ElButton type="primary" plain @click="showPopupMenu" title="显示菜单栏">
        <ElIcon>
            <Menu />
        </ElIcon>
    </ElButton></div>

    <div class="user-avatar">
        <ElButton text style="padding: 0" @click="goLogin"><img src="assets/i/login.png" alt="User Avatar"></ElButton>
    </div>
</header>

<style>
@media screen and (max-width: 599px) {
.ws>>> { /* wide screen */
    display: none;
}
}
.headerbar_container>>> {
    display: flex;
    align-items: center;
    box-shadow: 0 0 5px 0 #ccc;
    z-index: 100;
    --border: 1px solid var(--el-menu-border-color);
}
.headerbar_container[v-deep] > a.favicon {
    border-bottom: var(--border);
    border-right: var(--border);
}
.headerbar_container[v-deep] > a.favicon,
.headerbar_container[v-deep] > a.favicon > img {
    height: 58px;
}
.headerbar_container[v-deep] > .user-avatar {
    height: 58px;
    border-bottom: var(--border);
    border-left: var(--border);
    display: flex;
    align-items: center;
    padding: 0 10px;
}
.headerbar_container[v-deep] > .el-menu,
.headerbar_container[v-deep] > div.el-menu-container {
    flex: 1;
}
.headerbar_container[v-deep] > .m-menu {
    display: none;
    flex: 1;
    text-align: right;
    padding-right: 1em;
}
@media screen and (max-width: 599px) {
.headerbar_container[v-deep] > .el-menu,
.headerbar_container[v-deep] > div.el-menu-container {
    display: none;
}
.headerbar_container[v-deep] > .m-menu {
    display: unset;
}
}
.headerbar_container[v-deep] > .el-menu-container[data-is-popup="true"]::before {
    content: "";
    position: fixed;
    left: 0; right: 0; top: 0; bottom: 0;
    background-color: rgba(0,0,0,0.1);
}
.headerbar_container[v-deep] > .el-menu-container[data-is-popup="true"] {
    position: fixed;
    z-index: 100;
    left: 10px; right: 10px; top: 10px; bottom: 10px; 
    overflow: auto;
}
</style>